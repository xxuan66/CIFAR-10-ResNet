# CIFAR-10-ResNet
基于ResNet的CIFAR-10分类实现

## 项目背景

CIFAR-10数据集是一个常用的图像分类数据集，包含60000张32x32的彩色图像，分为10个类别（每个类别6000张图像）。该数据集具有多样化的图像内容，适合用来评估图像分类算法的性能。

本项目旨在基于ResNet（残差网络）构建一个图像分类模型，利用ResNet的残差连接技术来提高模型的训练效果，缓解深度网络中的梯度消失问题，从而提高分类准确率。

## 核心技术

1. **残差连接**：通过引入短路连接（skip connection），将输入直接加到输出上，从而帮助解决梯度消失问题，使得更深层的网络也能有效训练。
2. **批标准化（Batch Normalization）**：通过标准化每一层的输出，帮助加速模型的收敛，并提升模型的泛化能力。
3. **池化层**：通过最大池化操作降低特征图的维度，减少计算量并提高计算效率。

## 项目结构

```plaintext
.
├── dataset/
│   └── CIFAR10/       # 存放CIFAR-10数据集的文件夹
├── ResNet_CIFAR10.py  # 包含模型、训练和测试的代码
├── README.md          # 项目的文档说明
└── requirements.txt   # 项目的依赖库
```

## 安装依赖

确保你已经安装了Python 3.x版本，并创建了一个虚拟环境（可选）。然后，运行以下命令来安装所需的库：

```bash
pip install -r requirements.txt
```

`requirements.txt`文件内容如下：

```
torch==2.1.0
torchvision==0.15.0
matplotlib==3.6.2
numpy==1.23.4
```

## 使用说明

### 1. 数据集下载

CIFAR-10数据集将在运行时自动下载，存放在`./dataset/CIFAR10/`目录中。你也可以手动从[官网](https://www.cs.toronto.edu/~kriz/cifar.html)下载并将数据集放入该目录。

### 2. 代码实现

项目的核心代码实现了ResNet模型，包含以下几个主要部分：

- **数据加载与预处理**：通过`torchvision`加载CIFAR-10数据集并进行标准化处理。
- **ResNet模型定义**：定义了一个基本的ResNet18模型，包含多个残差块。
- **训练与测试**：实现了模型的训练与测试函数，输出训练过程中的损失和最终的准确率。

### 3. 训练模型

在运行代码前，首先确保你的环境支持CUDA（如果有GPU）。然后，运行以下命令开始训练ResNet模型：

```bash
python ResNet_CIFAR10.py
```

训练过程将在每个epoch结束时输出当前的损失值，训练完成后会输出测试集的准确率。

### 4. 结果展示

模型训练完成后，会显示每个类别的一张样本图像，并在测试集上输出准确率。例如：

```bash
Epoch 1, Loss: 1.8342
Epoch 2, Loss: 1.4501
...
Accuracy: 87.5%
```

### 5. 可视化

项目中还包含了数据集的可视化部分，展示了每个类别的一个样本图像，帮助我们更好地理解数据集。

### 6. 结果分析

通过使用ResNet网络，我们能够在CIFAR-10数据集上获得较高的分类准确率，并验证了残差连接在深度网络训练中的优势。

## 代码说明

### `ResidualBlock` 类

该类定义了ResNet的核心组成部分——残差块。每个残差块包含两个卷积层和批标准化层，在每个块的输出上加上输入（残差连接）以帮助信息传递。

### `ResNet` 类

该类定义了ResNet的整体架构，包含4个不同的层，每一层都由多个残差块构成。最后通过平均池化和全连接层输出分类结果。

### `train` 函数

训练函数负责执行模型的训练过程，包括计算损失、反向传播和优化。

### `test` 函数

测试函数在验证集上评估模型的性能，输出准确率。


